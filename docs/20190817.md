# Mobx 源码初探 - observable（二）

> [上一节](./20190811.md)讲到，`observable` 不仅支持 `decorator` 方式，还支持方法调用。

`observable` 共支持 `box`、`shallowBox`、`array`、`shallowArray`、`map`、`shallowMap`、`set`、`object`、`shallowObject`、`ref`、`shallow`、`deep`、`struct` 13 种方法。

其中 `box`、`shallowBox`、`array`、`shallowArray`、`map`、`shallowMap`、`set` 会判断参数是否大于 **2**，如果大于则报错。`shallowObject` 会判断第二个参数是否为 `string`，如果不是则报错。`ref`、`shallow`、`deep`、`struct` 四个方法很有意思，其中 `deep` 对应的是 `deepDecorator` 方法，当我们调用 `observable.deep()` 就相当于调用 `@observable`，剩下的三个则对应不同的 `enhancer`。

## 四个 enhancer

`mobx` 共有四个 `enhancer`，为 `deepEnhancer`、`shallowEnhancer`、`referenceEnhancer` 和 `refStructEnhancer`。`deepEnhancer` 在上一节已经讲过，其是任何 `observable` 都使用的默认的调节器。它将任何(尚未成为 `observable` )数组，映射或纯对象克隆并转换为 `observable` 对象，并将其赋值给给定属性，这里主要讲下剩下的三个。

### shallowEnhancer

只能与集合组合使用。 将任何分配的集合转换为 `observable`，但该集合的值将按原样处理。

### referenceEnhancer

禁用自动的 `observable` 转换，只是创建一个 `observable` 引用。

### refStructEnhancer

就像 `referenceEnhancer`, 但会忽略结构上等于当前值的新值。
